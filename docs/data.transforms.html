---

title: Helper functions for processing data and basic transforms

keywords: fastai
sidebar: home_sidebar

summary: "Functions for getting, splitting, and labeling data, as well as generic transforms"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_data.transforms.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.showdoc</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get,-split,-and-label">Get, split, and label<a class="anchor-link" href="#Get,-split,-and-label">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For most data source creation we need functions to get a list of items, split them in to train/valid sets, and label them. fastai provides functions to make each of these steps easy (especially when combined with <code>fastai.data.blocks</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get">Get<a class="anchor-link" href="#Get">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll look at functions that <em>get</em> a list of items (generally file names).</p>
<p>We'll use <em>tiny MNIST</em> (a subset of MNIST with just two classes, <code>7</code>s and <code>3</code>s) for our examples/tests throughout this page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/7&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_files" class="doc_header"><code>get_files</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>path</code></strong>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get all the files in <code>path</code> with optional <code>extensions</code>, optionally with <code>recurse</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the most general way to grab a bunch of file names from disk. If you pass <code>extensions</code> (including the <code>.</code>) then returned file names are filtered by that list. Only those files directly in <code>path</code> are included, unless you pass <code>recurse</code>, in which case all child folders are also searched recursively. <code>folders</code> is an optional list of directories to limit the search to.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t7</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#709) [Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7861.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7582.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/8450.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/9380.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7214.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7794.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7634.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/992.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/8710.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/9913.png&#39;)...]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's often useful to be able to create functions with customized behavior. <code>fastai.data</code> generally uses functions named as CamelCase verbs ending in <code>er</code> to create these functions. <a href="/data.transforms#FileGetter"><code>FileGetter</code></a> is a simple example of such a function creator.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileGetter" class="doc_header"><code>FileGetter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms#get_files"><code>get_files</code></a> partial function that searches path suffix <code>suf</code>, only in <code>folders</code>, if specified, and passes along args</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fpng</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">fpng_r</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng_r</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image_files" class="doc_header"><code>get_image_files</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get image files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simply <a href="/data.transforms#get_files"><code>get_files</code></a> called with a list of standard image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageGetter" class="doc_header"><code>ImageGetter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="/data.transforms#get_image_files"><code>get_image_files</code></a> partial function that searches path suffix <code>suf</code> and passes along <code>kwargs</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as <a href="/data.transforms#FileGetter"><code>FileGetter</code></a>, but for image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">ImageGetter</span><span class="p">(</span>   <span class="s1">&#39;train&#39;</span><span class="p">,</span>                    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)(</span><span class="n">path</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_text_files" class="doc_header"><code>get_text_files</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_text_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get text files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split">Split<a class="anchor-link" href="#Split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next set of functions are used to <em>split</em> data into training and validation sets. The functions return two lists - a list of indices or masks for each of training and validation sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSplitter" class="doc_header"><code>RandomSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Create function that splits <code>items</code> between train/val with <code>valid_pct</code> randomly.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="IndexSplitter" class="doc_header"><code>IndexSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>IndexSplitter</code>(<strong><code>valid_idx</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> so that <code>val_idx</code> are in the validation set and the others in the training set</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">IndexSplitter</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GrandparentSplitter" class="doc_header"><code>GrandparentSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train_name</code></strong>=<em><code>'train'</code></em>, <strong><code>valid_name</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> from the grand parent folder names (<code>train_name</code> and <code>valid_name</code>).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/9932.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7189.png&#39;</span><span class="p">,</span> 
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7320.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/9833.png&#39;</span><span class="p">,</span>  
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/7666.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/925.png&#39;</span><span class="p">,</span>
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/724.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/93055.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FuncSplitter" class="doc_header"><code>FuncSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FuncSplitter</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> by result of <code>func</code> (<code>True</code> for validation, <code>False</code> for training set).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">FuncSplitter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MaskSplitter" class="doc_header"><code>MaskSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MaskSplitter</code>(<strong><code>mask</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> depending on the value of <code>mask</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">MaskSplitter</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileSplitter" class="doc_header"><code>FileSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileSplitter</code>(<strong><code>fname</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> depending on the value of <code>mask</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;valid.txt&#39;</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">Path</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]))</span>
    <span class="n">splitter</span> <span class="o">=</span> <span class="n">FileSplitter</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ColSplitter" class="doc_header"><code>ColSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L117" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ColSplitter</code>(<strong><code>col</code></strong>=<em><code>'is_valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> (supposed to be a dataframe) by value in <code>col</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">]})</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">ColSplitter</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splits</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Label">Label<a class="anchor-link" href="#Label">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final set of functions is used to <em>label</em> a single item of data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parent_label" class="doc_header"><code>parent_label</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L126" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parent_label</code>(<strong><code>o</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with the parent folder name.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="/data.transforms#parent_label"><code>parent_label</code></a> doesn't have anything customize, so it doesn't return a function - you can just use it directly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="s2">&quot;fastai_dev/dev/data/mnist_tiny/train/3/9932.png&quot;</span><span class="p">),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">parent_label</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegexLabeller" class="doc_header"><code>class</code> <code>RegexLabeller</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L131" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegexLabeller</code>(<strong><code>pat</code></strong>, <strong><code>match</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Label <code>item</code> with regex <code>pat</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="/data.transforms#RegexLabeller"><code>RegexLabeller</code></a> is a very flexible function since it handles any regex search of the stringified item. Pass <code>match=True</code> to use <code>re.match</code> (i.e. check only start of string), or <code>re.search</code> otherwise (default).</p>
<p>For instance, here's an example the replicates the previous <a href="/data.transforms#parent_label"><code>parent_label</code></a> results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;</span><span class="si">{os.path.sep}</span><span class="s1">(\d)</span><span class="si">{os.path.sep}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d*)&#39;</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="s1">&#39;9932&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ColReader" class="doc_header"><code>class</code> <code>ColReader</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L143" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ColReader</code>(<strong><code>cols</code></strong>, <strong><code>pref</code></strong>=<em><code>''</code></em>, <strong><code>suff</code></strong>=<em><code>''</code></em>, <strong><code>label_delim</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Read <code>cols</code> in <code>row</code> with potential <code>pref</code> and <code>suff</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>cols</code> can be a list of column names or a list of indices (or a mix of both). If <code>label_delim</code> is passed, the result is split using it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;a b c d&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1 2&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;1 2 3&#39;</span><span class="p">]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="s1">&#39;0a1 0b1 0c1 0d1&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label_delim</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]])</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">],</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[(</span><span class="s1">&#39;0a1&#39;</span><span class="p">,</span> <span class="s1">&#39;0a1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0b1&#39;</span><span class="p">,</span> <span class="s1">&#39;0b1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0c1&#39;</span><span class="p">,</span> <span class="s1">&#39;0c1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0d1&#39;</span><span class="p">,</span> <span class="s1">&#39;0d1&#39;</span><span class="p">)])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoryMap" class="doc_header"><code>class</code> <code>CategoryMap</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L159" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoryMap</code>(<strong><code>col</code></strong>, <strong><code>sort</code></strong>=<em><code>True</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <code>CollBase</code></p>
</blockquote>
<p>Collection of categories with the reverse mapping in <code>o2i</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_fail</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unseen label&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;#na#&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Categorize" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Reversible transform of category string to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Category" class="doc_header"><code>class</code> <code>Category</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L188" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Category</code>() :: <code>str</code></p>
</blockquote>
<p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategorize" class="doc_header"><code>class</code> <code>MultiCategorize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L191" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="/data.transforms#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Reversible transform of multi-category strings to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategory" class="doc_header"><code>class</code> <code>MultiCategory</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L209" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategory</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <code>L</code></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">MultiCategorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([]),</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OneHotEncode" class="doc_header"><code>class</code> <code>OneHotEncode</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L214" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OneHotEncode</code>(<strong><code>c</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>One-hot encodes targets</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Works in conjunction with <code>MultiCategorize</code> or on its own if you have one-hot encoded targets (pass a <code>vocab</code> for decoding and <code>do_encode=False</code> in this case)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">OneHotEncode</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="p">[[</span><span class="n">MultiCategorize</span><span class="p">(),</span> <span class="n">OneHotEncode</span><span class="p">()]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])]),</span> <span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorMultiCategory</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EncodedMultiCategorize" class="doc_header"><code>class</code> <code>EncodedMultiCategorize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L227" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EncodedMultiCategorize</code>(<strong><code>vocab</code></strong>) :: <a href="/data.transforms#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Transform of one-hot encoded multi-category that decodes with <code>vocab</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">EncodedMultiCategorize</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegressionSetup" class="doc_header"><code>class</code> <code>RegressionSetup</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L235" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegressionSetup</code>(<strong><code>c</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Transform that floatifies targets</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">RegressionSetup</span><span class="p">()</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">RegressionSetup</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.</span><span class="p">),))</span>

<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]],</span> <span class="n">RegressionSetup</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">dsets</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq_type</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]),))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_c" class="doc_header"><code>get_c</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L245" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_c</code>(<strong><code>dls</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-to-end-dataset-example-with-MNIST">End-to-end dataset example with MNIST<a class="anchor-link" href="#End-to-end-dataset-example-with-MNIST">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's show how to use those functions to grab the mnist dataset in a <a href="/data.core#Datasets"><code>Datasets</code></a>. First we grab all the images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we split between train and validation depending on the folder.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">)</span>
<span class="n">train</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">valid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#3) [Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7861.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/7582.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/train/3/8450.png&#39;)],
 (#3) [Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/valid/3/8171.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/valid/3/7529.png&#39;),Path(&#39;/home/sgugger/.fastai/data/mnist_tiny/valid/3/8087.png&#39;)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our inputs are images that we open and convert to tensors, our targets are labeled depending on the parent directory and are categories.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="k">def</span> <span class="nf">open_img</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span><span class="n">Path</span><span class="p">):</span> <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img2tensor</span><span class="p">(</span><span class="n">im</span><span class="p">:</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span> <span class="k">return</span> <span class="n">TensorImage</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">open_img</span><span class="p">,</span> <span class="n">img2tensor</span><span class="p">],</span>
        <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">decode_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">yd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">xd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">show_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAEIElEQVR4nO2aPUtsVxSGn+X1WxEbFSQqEoRARAUtTKOxUSF/wCAiQlRSiYqFNjY2QWwipjCFhZYRsUlhIUFiJVH8iGgIgoJcULFQdNAYd4pxz3h2RmdwHM/ce9cDw3H2PnP24j2v66y9ZsQYgxImxe8Akg0VxEEFcVBBHFQQBxXEQQVx8F0QEZkTkfciciEif4nId77G43dhJiJfAn8bY25E5AvgN+AbY8wffsTju0OMMX8aY27s24fX537F47sgACLyk4hcA3vAe+BX32Lx+1/GIiLvgK+Ar4EfjDH/+BFHUjgEwBjzrzHmd+Az4Hu/4kgaQR6RyqeaQ0SkUETaRCRXRN6JSAvwLbDsW0x+5hARKQB+AaoJ3pxD4EdjzM++xZQsSTVZSMYc4isqiIMK4qCCOKRGmf+YM65EGlSHOKggDiqIgwrioII4qCAOKoiDCuKggjioIA4qiIMK4qCCOETb7SaU4+NjAI6OjkJjZWVlABQXF/sSkzrE4VUcsrGxAcD+/r5nfGRkBACRiK0Hzs/PAbi8vAyN5eXlAbC5uQlASUnJa4QYM+oQh2hfQzw72dTUBMDKykrE+fv7ewBSUoK6Z2dnA1BYWBi8+MPap6enXF9fez5bXV0NwPr6+nMhxIN2zGIhrhxiHZKTk+MZ7+/vjzheVFQEQHl5OQB3d3cAtLe3Mz8/7zl3aWkpntBejDrEIa4cEi/Dw8MAjI+Ph8Y6OjoAmJmZSeTSoDkkNt60Uj07OwNgbGwMgMnJSSBYp9i/e3t73zKk/6EOcXgThwQCAQAmJiaAsDNsfTI1NUVPTw8ANzc3nuNTZGRkeI6vRUKTqhWisrISgMPDQ898VlYWEE6kADs7OwCsrq4GA3yi7K+vrwegqqoKgM7OTgBqa2sBSE2Neq81qcZCQh0yOzsLQFdXV+SLP6wdyQV2zpbwW1tbMX22oaEBgOXlqD9TU4fEQkIdcnFxAUBjY2NwsYe72dbWFrz4o7tsx/Lz8z3XSE9PB+D29tYzbpNuc3MzANvb2555uy14BnVILCT0sWubPbaB9BSBQCD0BDo5OQGgrq7Oc05mZqbnvS373dxiH+kvRR3i4GuT2TI4OBhqNE9PT0c8x9Y0o6OjQLjIs3mpu7vbc3wp6hAHXx1ydXUFwMLCQqjCLCgo8JxzcHAAwNDQEACLi4tAuB1pG9kDAwMApKWlxRWTOsTBV4fYvUxLSwtzc3MAVFRUAOGNn20Z2Ca0rWmsU3Jzc181JnWIg68OsS7o6+tjb28PgLW1Nc9caWkpEGwRALS2tiY2poRe/QPE1ybzY+y+Z3d3FwhXpjU1NYlaUvcysZA0DvEBdUgsqCAOKoiDCuKggjioIA4qiIMK4qCCOETb7Ub+YvUjRh3ioII4qCAOKoiDCuKggjj8ByGsLV3mPVo8AAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToTensor" class="doc_header"><code>class</code> <code>ToTensor</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L254" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToTensor</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>False</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Convert item to appropriate tensor class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IntToFloatTensor" class="doc_header"><code>class</code> <code>IntToFloatTensor</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L259" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IntToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>255.0</code></em>, <strong><code>div_mask</code></strong>=<em><code>1</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>True</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">TensorImage</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">(),</span><span class="n">TensorMask</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">IntToFloatTensor</span><span class="p">(</span><span class="n">as_item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">TensorMask</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="broadcast_vec" class="doc_header"><code>broadcast_vec</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L271" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>broadcast_vec</code>(<strong><code>dim</code></strong>, <strong><code>ndim</code></strong>, <strong>*<code>t</code></strong>, <strong><code>cuda</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Make a vector broadcastable over <code>dim</code> (out of <code>ndim</code> total) by prepending and appending unit axes</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalize" class="doc_header"><code>class</code> <code>Normalize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L280" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalize</code>(<strong><code>mean</code></strong>=<em><code>None</code></em>, <strong><code>std</code></strong>=<em><code>None</code></em>, <strong><code>axes</code></strong>=<em><code>(0, 2, 3)</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Normalize/denorm batch of <a href="/torch_core#TensorImage"><code>TensorImage</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="n">broadcast_vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntToFloatTensor</span><span class="p">,</span> <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)]</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">default_device</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.cuda.FloatTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">xd</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mi">1</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Just for visuals</span>
<span class="kn">from</span> <span class="nn">fastai2.vision.core</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAFLUlEQVR4nO2be2xURRSHv9NtKRQUSKGoaYFAbaiUoLagEBI1kYcIkhhR8RFTFExrUOMjGoOEPzSKIAkgiiGGxFINQSAahUSlImLxgVSDSFEipSUtBhWK8ijd7fjHbIEdluV2u9276vmSptvZuXNPf/d3z8ycuyvGGJSzpPkdQKqhgjioIA4qiIMK4qCCOKggDr4LIiKrRaRJRI6JyM8i8pCv8fi9MBOR4cA+Y0yLiAwDtgC3GmO+8yMe3x1ijNltjGlp/zP8M9SveHwXBEBEXheRE0At0ARs9C0Wv2+ZdkQkAIwBbgQWGGNa/YgjJRwCYIwJGWO2AblAmV9xpIwg55DO/zWHiEiOiNwtIr1EJCAiE4EZQJVvMfmZQ0SkP/AeMBJ7cQ4AS40xK32LKVWSaqqQijnEV1QQBxXEQQVxSI/15vi06f/ZjPtJ21qJ1q4OcVBBHFQQBxXEQQVxUEEcVBCHmOuQRHNy2mgAerz/DQC/zRkLQKjH2T6V5YsBGJ7RDYCA2GuWX2lrRvnvHAPA1OzukhjVIQ4xt/+JWqlmf9kXgEcu3wzA+iMlAMzN2QZAVlqG57FWNQ8G4INp1wEQ+uXXuGLSlapHujSH/DlzDACVAxcBcEmazQsll30d7uHdGe2U9q4DYMFzkwAoKO1cjC7qEIcudUj2298CcHievV1n758MwN7DOQCEdl8KwNCVDRyanAdA3732Id7+adZNP925LOrYu8YvB+D2sQ8DINU/JCRmdYhDlzrEBIMAlJU9BkDPmnoAcg9FriGCQL83DwIQ6NMbgML5WTHHzpCAfSFRJ4u4UYc4JGWlmrnJ5pKgh75HJxYC8NmV0XPHKWNHGb3qCQDy6xs8j+0FdYhDUvcyF+LUlNH8XnocgE2jFoVbM6P2HbfkSQAGL6wGEueMdtQhDkl1iKTb06UVDAGgebG9vq8WvME1mW3hXtGdUVo3AYCB6xqBxDujHXWIQ1IdcmCurYd8P2uJ52PKG24CoPkO65xgU12iw4pAHeKQFIccecDuer94cGG4pZvnY2uP2n1P64QBAKSFBgPQe/VXCYvvXFJi2o1F1Yg19sUI+ysULmgV5z8OwKAXdwBgWk8n5Hx6yzgkpYTYTs+t/QF4d2jkx1Abgy3cvOGpiLa27nYarp26POaYRRWPAjDk2e0dikVLiB5JqkPSB9kikMnqHvlGMHR+sTi8rQ8Myweg9bVTAHw4bH1Et2cO2YS9p7hjSzV1iEeS6pDOkJ6XC0DO2mYAVuTZj7L+eNqGWD7PFqH6VHjLJeoQj8S1DmkbdzUA9ZPsM8i8T21hOLBlZ4LCOp/6uwYCMDJzW0R7UTd7obe+vBSA2ypGdeo86hCHuByy7z679K6daq/K9hl241Vecw8A/SoiC8RZH1nnhK4vAqAl++JL979m2ofaZQVbAZjeyxaO3MeeB4J2hfpC4y3hlmPe/5EoqEMc4ppl1h20G6szjwIuwtid9wLwUuEGAG7ocaJDQcaiZImdXa54pbpDx+ks45G4csiU2XMAmL/sLQDGdG+J1Z3qayvjOU1MFv5ht79565sACCVoXHWIQ1wOydxoHzw9nzkLgOK5kV+x7ZfxNwBPZ+/qTGwAfH7Szlgbm0cCsHmNLUOecca+/Z0+x7moQxy6ZC8TGGDLfg3358fsd7zI5p4941ec995VVbMBGFRhZ7KMj3fEE8oF0VnGI/+a3W6iUYd4RAVxUEEcVBAHFcRBBXFQQRz0u/8O6hAHFcRBBXFQQRxUEAcVxOEf5GRiDUnfGjkAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAEr0lEQVR4nO2bf2jUZRzHX5/dnfvRhjg1w1mztZVugUkjWSgUNJYsikWrVuQCHSSRGaNfRGQEUVFB1ooIy8BCrIgo0lJKaTQ1LXCr1rS5tamTxbSZa5d3e/rj2ZV7tp3fo9t9j/q84Dju7nm+e/P+vu/h83menRhjUP4hw28B6YYa4qCGOKghDmqIgxrioIY4+G6IiGwSkWMiMigiHSKyylc9fhdmIlIGHDLGhEVkAbATqDbG7PdDj+8JMcZ8b4wJx16OPi7xS4/vhgCIyKsiMgS0A8eAT33T4vdXJoaIBIAK4BrgWWPMGT90pEVCAIwxUWNMMzAPWO2XjrQx5CyC/F/XEBE5X0RuF5FcEQmISBVQB3zhmyY/1xARmQ28DyzC3pxuYL0x5g3fNKXLopoupOMa4itqiIMa4qCGOATjfViZUfufXXG3j7wnE72vCXFQQxzUEAc1xEENcVBDHNQQh7h1SLI4/HQFAK316wHoPGM3w27c3AhAwa4ImVu/SYWUc6IJcUhJQiLnjS14i0IhANrusokZuCPM0OiQ6rcftGNe/AGA6MnfUiHxbzQhDnE3iJLVy0hmJgDRq0oBOPnwaQCaF78z6Zzm4SwAXu69DoD+posByN2yOxmStJfxSkoSMu6PhqYBcHjdlQCsqfmEVdM74845GrGHe43dNQD0bCwGYHbLrwBEfzyYkAZNiEd8SYhLoKSI4cIZAIQePQ7AxpLNAOQHMuPOLd1yHwDFDyS2tmhCPJIWCZmIE3fb6va5x18HoCIrPOG4z4amA9BUcmlC19eEeCQlleqkZATsc3kpfzz1OwAjxt64a+e0AJMnI8be08k9BtaEOKQ0IcGCuQB0NswHIGvxAAC7y9/0fI19YZuqrYOLANi/omz0k/akaNSEOKQkIYGyywCo/eBLAOryPjrnnIGoXTtiXXDlx3bvZMFL/QBED8Yq2+QkI4YmxCElCRkuyAOgLu/IpGNWdlcCsHfXQsDuogHktNo5JUf2ABCdMpWWlBgS+nwfAJVttwKw/fIt48Zsmr8TgCWvWUOmbbNbipEU6Dsb/co4pLR0DywsAeDnddkAHFi6YdyYUyN/ArC2pxqAEzfb5i7SdzyZUrR094o/zd1oyZ5RahOz7N3vaJzZNuHQ+q4qAE7dZlMV6Z18YU4ETYhH0qL9D144j+47LwLgq3ufByAnIzRmzPL6ewAI7UjOjyQ0IR7xt/0fJdLTS8EzvQD0r7ahLPTpVmlCHKYkISNLrwAg1GePIYeLZgKQfaAHmLimCBTbg6gQzVMhyTOaEIekJCR4wRwAuppmAfBheZN9HrRJWZtvD66XPbYGgFnNOQBE83MB+GV5Hg212wCYG4x/7DDVaEIckpKQ3jq70fv1khcAyBJ7VBlLRoyihp8AuP4RW5XG2w6IHV3e33ULANntfcDUd7+aEIekVqodG8oBaK16BYCQBBIWFPt3qxVP2i3D/LdaEr6GF7RS9ciU9DJHH7oagPCMsdNX3rADGL+21HTcxKE9hQAUPfEtACYc/4Dq36IJ8UhadLt+oAnxiBrioIY4qCEOaoiDGuKghjjob/8dNCEOaoiDGuKghjioIQ5qiMNfCxNl8dTjUcQAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAEGklEQVR4nO2bXWwUVRiGn2+37Uh/XNhig8gNgkVSQiOJpNbEeINCiEZXMfUCbjCKVi6qYjTxJ5HEpFeWIiLBxJv6j4okGhMFjTFCIkLaWEHFJphgo5L4A1S3ZXu8mG5hP9u6SZk5o35Pshc752zny7vPnjnnzFSccxjnSPkuIGlYIAoLRGGBKCwQhQWisEAU3gMRkR4RGRSR30XkGxG5y2s9vidmItIEHHPO5UXkSuBjYLVz7gsf9Xg3xDnX75zLF9+OvRb4qsd7IAAi8pyIDAFHgUHgPW+1+P7JFBGRNHANcD3Q6Zwb8VFHIgwBcM4VnHOfAvOAe33VkZhAzqOC/+sYIiINItImIrUikhaRG4E7gX3eavI5hojIJcAuoJnwyzkOdDvndnqrKSmDalJI4hjiFQtEYYEoLBBFxVSNK1Jr/rMj7gejb8hEx80QhQWisEAUFojCAlFYIAoLRGGBKCwQxZQz1ahI1dQA8HXnEgAGcju4/O17AFjY8ycAsr/XR2lmiMaLISfvWArAQG77+LGBW3cAMHjTaQBufnITANkX98damxmi8GJItv/0pG2XVtQC8NHmZwBYtqgDgPmPxGOKGaKYcpM5qv0QCQIAfstdBcCWp7cyNx3e3p03ZkiRnwpnALj2lYcAWPD4IQBcPs90sP2QMvFiyESkmhcD0PHmLgBuqJ741m7LwxsAyPQcmNb5zJAy8XKV0UgQ8MuSDADLgl/HjtaU9Pn+bHhlmtl/CggfIokCM0ThxZA/blkOwInbwnEimDHCV63Pj7XWTPiZ3OZw5lp/ONr5iBmiiNWQdH0WgO1dWwBoqpoxad9PwkUvHZ3hszOzX5jeVaVczBBFrIb8ePsiAJqq/vl5mMceuBuA2bvjXe3GGkjDgfCS+v5QOHVfWT359PvZrm4ANu1uib6w87CfjCJWQ0Z7jwDQvWo1AO33NQDQu6aL2tRFJX0XV1YCcKotNKTuVRtUvZCIxV3FZXM5vnUWAF+2vFTSlju2AoAz1/18Qc9pi7sySUQgZ0/8QKEvQ6Ev47uUZASSJBKx/E/XZ3m07fWSY0OjwwB899YVAMzhwo4hk2GGKLwakqqrA2DmHse6i0+WtB0crgJgTtdn8dYU69n+BXgxJD0rnHNU70kD8PL8D8fb+obDdf8T7RsBCPg81trMEEUshrjWZgC+XRuucl9buQ2A5UHleJ8RVwCgY307AMHeeM0oYoYoIjUkv+pqAN7ZGe5tZFLFLcPKv/VtfDe8AdXoyYwiZogiUkMGW8M/f86MUo4MDwFw//qNNO47GGUpZWOGKCI1ZOG2AQD61oZzi6VVpbti6556EIDs3ng3kqfCDFEkYsfMB7ZjViYWiMICUVggCgtEYf/7rzBDFBaIwgJRWCAKC0RhgSj+AnX7/nTO54VqAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAEoElEQVR4nO2bb2hVZRzHP7/tuolL1qbbapumtqnbMDFbJFL6JqwEiSRIQpgghC8SiRVBKfSiF2FRjOiFjbIyM4uF9gdbIgutDFnNlmnN2UxImPvTLNvWdu/Ti+fezftzbNfdbedSvw+M7T7n3HO+fM/3POf3PM+ZOOcwhkkLWkCqYYYozBCFGaIwQxRmiMIMUQRuiIjsEZGLInJZRH4Rkc2B6gm6MBORCuCsc65fRBYDDcBa51xjEHoCT4hz7pRzrj/2Mfpza1B6AjcEQEReE5G/gTPAReCzwLQEfcvEEJF0YAWwGnjBOTcQhI6USAiAcy7snDsGFANbgtKRMoZcRYj/ax8iIvki8oiI3CAi6SKyBtgAHAlMU5B9iIjkAR8CS/EX5zxQ45x7PTBNqdKppgqp2IcEihmiMEMUZogiNNrGe9Me/s/2uF9EPpCR2i0hCjNEYYYozBCFGaIwQxRmiMIMUZghCjNEYYYozBCFGaIYdbQ72URWLQOga9H0obbc030ApB39PhBNlhDFhCTkj40rAOgpiZ9ieOnRNwAIu5F9r8g4BkBxKHOo7fzgPwBs2bTVCzwytWvelhBFUgmpbAoDsD2vZsTtmTINgP7oMu2lsF/k/64/H4AzA7Oj+3WQl+5TcksoA4CHXq0H4GD5rGQkXjeWEEVSCdnbdCcAXRVZce1f7b0dgGl/xU/JzrwwCEDGoRMApE33T5eZh7N4Z/6huH0/3nhP9K9TyUi8biwhiqQSUlrlnwCtqv0mvk7o+61vLgKgeX7tUNsDp9d7YY1Tm4wYlhDFlFaqsrwCgN+3RwBorhxORvn7jwNQUn1iKiVdgyVEMSUJCRUVAtBS7U8XS0Y4+irGbfu2UlJ9HID0nBz/pfwx6o/2Tn+M7u6J1TqhR9MHjxrxWEMDAGtm9MRt74r4Mj23rJPuT0sBWFvsO9OnZ9ePeuydnUsAOHjB/47U+SIv710/KIz09Y1Ls90yilHfIEp2sbvteT/o+6Fq5NI+EWp7FgCwOftcQvs/174cgMZlo19rW+xOkElNSHqpv7rrDnwLQDjq/4tH74uePbqjgwX7/aM48zfVSXZH+52c7LjmyI1+uPDgW/6FxU3ZbXHb1xVVjqrNEpIgk/qUCbf4+/6j8ry49oXEF1+hokJ67poDwJ9zCgDI2f1N/ME6OuM+/vreUuDaZJTvjxZ4HB+XZkuIItBJ5hiXdmVxR/5JAFqeKBtxn1hN0/qyL9iaV9bGbV91cgMAC59tBiAyTi2WEEWgCQnNmwtATdk+3u5c6duazgLDV7j/fv+0KNjxMwB1cw8Aw9ORd9dvA6DsST8JEb5yJSlNlhDFpNYhY5485AMa/vxmPllcB8CXvTMAGCAdgCUZHQAURCehd7T7xPy4fh4Ag+faxnVuq0MSJNA+xA36SefLu4t55alyALbl/gQMTw0c7vVLFs/sqgKgcGdserJtUjRZQhSB9iFXExv3tK/2lWqo1586e8/4Ks6xsD4kQVKiUoXhcc+slsTmPSYLS4jCDFGYIQozRGGGKMwQhRmiMEMUZojC/vdfYQlRmCEKM0RhhijMEIUZovgXg/c2iIGpuXwAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#Lose type of tensors (to emulate predictions)</span>
<span class="n">test_ne</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Check that types are put back by dl.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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zne588Zcfao1mZmt69rmzm/ZeHwPd0j+eali5wREEScgijgBUcQJiCJOQBRxAqKIExCV2fvWPvvNcndeH/KVeumSTf7wHHd+2+jn3PkRA34v53L6hAmz/fel3efOpb20kvLjfWuBKkOcgCjiBEQRJyCKOAFRxAmIyuyRsZOmX+bOb77vMXc+qb//1piVtPTguZm9di2b9cPYxFnz/E3utYVyL0YAOycgijgBUcQJiCJOQBRxAqKIExBFnICozM45Gxa8585vbLjYnY+f+UHq1x5c/6s7v3bQJ6nvXcve/MN/S9EFHePc+WtPT3Tn3llmYfUa99paxM4JiCJOQBRxAqKIExBFnIAo4gREEScgKrO3xsxSfs8md77hvJZeWsl//TbGf07189aHK/r6+y+anjgb1u6/XWn9K++Xezl9Am+NCVQZ4gREEScgijgBUcQJiCJOQBRxAqL65DknoIRzTqDKECcgijgBUcQJiCJOQBRxAqKIExBFnIAo4gREEScgijgBUcQJiCJOQBRxAqKIExBFnIAo4gREEScgijgBUcQJiCJOQBRxAqKIExBFnIAo4gREEScgijgBUcQJiCJOQBRxAqLcjwAEkB12TkAUcQKiiBMQRZyAKOIERBEnIOpPsNJjU5jafSYAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#TODO: make the above check a proper test</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}
</div>
 

